# å¾…è¾¦äº‹é …

**æœ€å¾Œæ›´æ–°**: 2025-01-27

---

## ğŸ“‹ ä»»å‹™æ¦‚è¦½

- **å®‰å…¨é¢¨éšªä¿®å¾©**: 5/13 å·²å®Œæˆ âœ…
- **ç·¨è­¯æ¸¬è©¦**: 1/1 å·²å®Œæˆ âœ…
- **æ§‹å»ºå•é¡Œä¿®å¾©**: 1/4 å·²å®Œæˆ
- **æ–‡æª”ä»»å‹™**: 3/4 å·²å®Œæˆ
- **å­¸ç¿’è¨ˆåŠƒ**: å·²å®Œæˆ âœ…ï¼ˆç†è§£ç­‰ç´šï¼š85-90%ï¼‰

---

## ğŸ”’ å®‰å…¨é¢¨éšªä¿®å¾©ä»»å‹™

## âœ… å·²å®Œæˆï¼ˆé«˜é¢¨éšªï¼‰

- [x] **(A) ä¿®å¾©ç¡¬ç·¨ç¢¼çš„ API å¯†é‘°å•é¡Œ** +Security #é«˜é¢¨éšª {cm:2025-01-27} âœ…
  - **ä½ç½®**: `src/lib/event-report.ts`, `src-tauri/tauri.conf.json`, `src/app/core/setting/about/updater.tsx`
  - **å•é¡Œ**: ç¡¬ç·¨ç¢¼äº† UpgradeLink æœå‹™çš„ `accessKey`ã€`secretKey`ã€`appKey`
  - **ä¿®å¾©**: å·²ç§»é™¤æ‰€æœ‰ UpgradeLink ç›¸é—œåŠŸèƒ½ï¼ˆæœå‹™å·²ä¸å¯ç”¨ï¼‰
  - **è©³ç´°æ–‡æª”**: `docs/HARDCODED_KEYS.md`

- [x] **(A) å°‡ Access Token å¾ URL åƒæ•¸ç§»è‡³ HTTP Header** +Security #é«˜é¢¨éšª {cm:2025-01-27} âœ…
  - **ä½ç½®**: `src/lib/sync/gitee.ts`
  - **ä¿®å¾©**: æ‰€æœ‰ Gitee API è«‹æ±‚å·²æ”¹ç‚ºä½¿ç”¨ `Authorization: token ${accessToken}` Header

- [x] **(A) ç¦ç”¨ä¸å®‰å…¨çš„ HTTP å”è­°** +Security #é«˜é¢¨éšª {cm:2025-01-27} âœ…
  - **ä½ç½®**: `src-tauri/tauri.conf.json`
  - **ä¿®å¾©**: `dangerousInsecureTransportProtocol` å·²è¨­ç‚º `false`ï¼Œå¼·åˆ¶ä½¿ç”¨ HTTPS

- [x] **(A) é…ç½®å…§å®¹å®‰å…¨ç­–ç•¥ (CSP)** +Security #é«˜é¢¨éšª {cm:2025-01-27} âœ…
  - **ä½ç½®**: `src-tauri/tauri.conf.json`
  - **ä¿®å¾©**: å·²é…ç½®é©ç•¶çš„ CSP ç­–ç•¥ï¼Œé˜²æ­¢ XSS æ”»æ“Š

- [x] **(A) ä¿®å¾© XSS é¢¨éšªï¼ˆdangerouslySetInnerHTMLï¼‰** +Security #é«˜é¢¨éšª {cm:2025-01-27} âœ…
  - **ä½ç½®**: `src/app/core/record/chat/chat-preview.tsx`
  - **ä¿®å¾©**: å·²å®‰è£ DOMPurifyï¼Œåœ¨æ¸²æŸ“å‰æ¸…ç† HTML å…§å®¹

## â³ å¾…è™•ç†ï¼ˆé«˜é¢¨éšªï¼‰

- [ ] **(A) åŠ å¼· MCP æœå‹™å™¨å‘½ä»¤åŸ·è¡Œå®‰å…¨** +Security #é«˜é¢¨éšª @src-tauri/src/mcp.rs
  - **ä½ç½®**: `src-tauri/src/mcp.rs` (ç¬¬91-170è¡Œ)
  - **å•é¡Œ**: å…è¨±åŸ·è¡Œä»»æ„å‘½ä»¤å’Œåƒæ•¸ï¼Œå¯èƒ½å°è‡´å‘½ä»¤æ³¨å…¥æ”»æ“Š
  - **å»ºè­°**: åš´æ ¼é©—è­‰å’Œæ¸…ç†ç”¨æˆ¶è¼¸å…¥ï¼›ä½¿ç”¨ç™½åå–®é™åˆ¶å¯åŸ·è¡Œçš„å‘½ä»¤ï¼›å¯¦æ–½æœ€å°æ¬Šé™åŸå‰‡

- [ ] **(A) é©—è­‰ MCP HTTP æœå‹™å™¨ URL** +Security #é«˜é¢¨éšª @src/lib/mcp/client.ts
  - **ä½ç½®**: `src/lib/mcp/client.ts` (ç¬¬221è¡Œ)
  - **å•é¡Œ**: HTTP è«‹æ±‚ç›´æ¥ä½¿ç”¨ç”¨æˆ¶é…ç½®çš„ URLï¼Œæœªé€²è¡Œé©—è­‰
  - **é¢¨éšª**: å¯èƒ½å°è‡´ SSRF (Server-Side Request Forgery) æ”»æ“Š
  - **å»ºè­°**: é©—è­‰ URL æ ¼å¼å’Œå”è­°ï¼ˆåƒ…å…è¨± HTTPSï¼‰ï¼›ä½¿ç”¨ç™½åå–®é™åˆ¶å…è¨±çš„åŸŸå

- [ ] **(A) é©—è­‰å’Œæ¸…ç† MCP è‡ªå®šç¾© Headers** +Security #é«˜é¢¨éšª @src/lib/mcp/client.ts
  - **ä½ç½®**: `src/lib/mcp/client.ts` (ç¬¬213-218è¡Œ)
  - **å•é¡Œ**: ç›´æ¥è§£æç”¨æˆ¶æä¾›çš„ headersï¼Œå¯èƒ½åŒ…å«æƒ¡æ„å…§å®¹
  - **å»ºè­°**: é©—è­‰å’Œæ¸…ç† headersï¼›ç¦æ­¢æ•æ„Ÿ headersï¼›ä½¿ç”¨ç™½åå–®

## â³ å¾…è™•ç†ï¼ˆä¸­é¢¨éšªï¼‰

- [ ] **(B) é™åˆ¶æ–‡ä»¶ç³»çµ±æ¬Šé™** +Security #ä¸­é¢¨éšª @src-tauri/capabilities/default.json
  - **å•é¡Œ**: æ–‡ä»¶ç³»çµ±æ¬Šé™è¨­ç½®ç‚º `"path": "**"`ï¼Œå…è¨±è¨ªå•æ‰€æœ‰è·¯å¾‘
  - **å»ºè­°**: é™åˆ¶æ–‡ä»¶ç³»çµ±è¨ªå•ç¯„åœï¼Œåªå…è¨±è¨ªå•æ‡‰ç”¨ç¨‹åºéœ€è¦çš„ç‰¹å®šç›®éŒ„

- [ ] **(B) é™åˆ¶ HTTP ç¶²çµ¡æ¬Šé™** +Security #ä¸­é¢¨éšª @src-tauri/capabilities/default.json
  - **å•é¡Œ**: HTTP æ¬Šé™å…è¨±è¨ªå•æ‰€æœ‰ HTTP/HTTPS URL
  - **å»ºè­°**: ä½¿ç”¨ç™½åå–®é™åˆ¶å…è¨±è¨ªå•çš„åŸŸåå’Œ URL

- [ ] **(B) æ¸…ç† Console è¼¸å‡ºä¸­çš„æ•æ„Ÿä¿¡æ¯** +Security #ä¸­é¢¨éšª
  - **å•é¡Œ**: å¯èƒ½ç„¡æ„ä¸­è¼¸å‡ºæ•æ„Ÿä¿¡æ¯åˆ°æ§åˆ¶å°
  - **å»ºè­°**: ç§»é™¤æˆ–æ¢ä»¶åŒ–æ‰€æœ‰ console è¼¸å‡ºï¼ˆåƒ…åœ¨é–‹ç™¼ç’°å¢ƒï¼‰

- [ ] **(B) å¯©æŸ¥æ‰€æœ‰ SQL æŸ¥è©¢ç¢ºä¿åƒæ•¸åŒ–** +Security #ä¸­é¢¨éšª @src/db
  - **å•é¡Œ**: éœ€è¦ç¢ºèªæ‰€æœ‰ SQL æŸ¥è©¢éƒ½æ­£ç¢ºä½¿ç”¨åƒæ•¸åŒ–
  - **å»ºè­°**: å¯©æŸ¥æ‰€æœ‰æ•¸æ“šåº«æ“ä½œï¼Œç¢ºä¿æ²’æœ‰å­—ç¬¦ä¸²æ‹¼æ¥

- [ ] **(B) é©—è­‰æ–‡ä»¶è·¯å¾‘è™•ç†é‚è¼¯** +Security #ä¸­é¢¨éšª @src/lib/files.ts @src/lib/workspace.ts
  - **å•é¡Œ**: è·¯å¾‘è™•ç†é‚è¼¯è¤‡é›œï¼Œå¯èƒ½å°è‡´è·¯å¾‘éæ­·æ”»æ“Š
  - **å»ºè­°**: åš´æ ¼é©—è­‰æ‰€æœ‰è·¯å¾‘è¼¸å…¥ï¼›ç¢ºä¿è·¯å¾‘è¦ç¯„åŒ–å¾Œä¸æœƒé€ƒé€¸å·¥ä½œå€

- [ ] **(B) æª¢æŸ¥ localStorage ä½¿ç”¨ï¼Œç§»é™¤æ•æ„Ÿä¿¡æ¯** +Security #ä¸­é¢¨éšª
  - **å•é¡Œ**: localStorage å¯èƒ½å­˜å„²æ•æ„Ÿä¿¡æ¯ï¼Œå®¹æ˜“è¢« XSS æ”»æ“Šè®€å–
  - **å»ºè­°**: åƒ…å­˜å„²éæ•æ„Ÿä¿¡æ¯ï¼›æ•æ„Ÿä¿¡æ¯æ‡‰ä½¿ç”¨ Tauri Store æˆ–åŠ å¯†å­˜å„²

- [ ] **(B) é©—è­‰ PicGo URL é…ç½®** +Security #ä¸­é¢¨éšª @src/lib/imageHosting/picgo.ts
  - **å•é¡Œ**: ç›´æ¥ä½¿ç”¨ç”¨æˆ¶é…ç½®çš„ URL é€²è¡Œè«‹æ±‚ï¼Œæœªé©—è­‰
  - **å»ºè­°**: é©—è­‰ URL æ ¼å¼ï¼›åƒ…å…è¨± localhost æˆ–ç‰¹å®šåŸŸå

- [ ] **(B) åŠ å¯†å­˜å„² S3 æ†‘è­‰** +Security #ä¸­é¢¨éšª @src/stores/imageHosting.ts
  - **å•é¡Œ**: S3 æ†‘è­‰å­˜å„²åœ¨ Tauri Store ä¸­æœªåŠ å¯†
  - **å»ºè­°**: è€ƒæ…®åŠ å¯†å­˜å„²ï¼›ä½¿ç”¨ç³»çµ±æ†‘è­‰ç®¡ç†å™¨

## â³ å¾…è™•ç†ï¼ˆä½é¢¨éšªï¼‰

- [ ] **(C) æ”¹é€² Cookie å®‰å…¨è¨­ç½®** +Security #ä½é¢¨éšª @src/components/ui/sidebar.tsx
- [ ] **(C) ç¢ºä¿æ‰€æœ‰ JSON.parse éƒ½æœ‰ç•°å¸¸è™•ç†** +Security #ä½é¢¨éšª
- [ ] **(C) é©—è­‰å‹•æ…‹å°å…¥çš„èªè¨€æ–‡ä»¶è·¯å¾‘** +Security #ä½é¢¨éšª @src/i18n/request.ts

---

## ğŸ—ï¸ æ§‹å»ºå’Œæ‰“åŒ…å•é¡Œä¿®å¾©ä»»å‹™

- [ ] **(A) ä¿®å¾© NODE_ENV ç’°å¢ƒè®Šé‡å•é¡Œ** +Build #é«˜é¢¨éšª @next.config.ts
  - **å•é¡Œ**: `assetPrefix` ä¾è³´ `NODE_ENV === 'production'`ï¼Œæ§‹å»ºæ™‚å¯èƒ½æœªæ­£ç¢ºè¨­ç½®
  - **å»ºè­°**: åœ¨ `package.json` çš„ `build` è…³æœ¬ä¸­æ˜ç¢ºè¨­ç½® `NODE_ENV=production`

- [ ] **(B) çµ±ä¸€ç‰ˆæœ¬è™Ÿç®¡ç†** +Build #ä¸­é¢¨éšª
  - **å•é¡Œ**: ç‰ˆæœ¬è™Ÿä¸ä¸€è‡´ï¼ˆ`tauri.conf.json`: 0.22.3, `package.json`: 0.1.0, iOS: 0.22.2ï¼‰
  - **å»ºè­°**: çµ±ä¸€ç‰ˆæœ¬è™Ÿç®¡ç†ç­–ç•¥ï¼›ä½¿ç”¨è…³æœ¬è‡ªå‹•åŒæ­¥ç‰ˆæœ¬è™Ÿ

- [x] **(C) è©•ä¼° Turbopack ç”Ÿç”¢æ§‹å»ºç©©å®šæ€§** +Build #ä½é¢¨éšª {cm:2025-01-27} âœ…
  - **ä¿®å¾©**: ç”Ÿç”¢æ§‹å»ºå·²æ”¹ç‚ºä½¿ç”¨æ¨™æº– webpackï¼›ä¿ç•™é–‹ç™¼ç’°å¢ƒä½¿ç”¨ Turbopack

- [ ] **(C) é©—è­‰æ§‹å»ºç”¢ç‰©è·¯å¾‘é…ç½®** +Build #ä½é¢¨éšª @src-tauri/tauri.conf.json
  - **å•é¡Œ**: éœ€è¦ç¢ºèª `frontendDist: "../out"` èˆ‡ Next.js è¼¸å‡ºç›®éŒ„ä¸€è‡´

---

## âœ… ç·¨è­¯æ¸¬è©¦ä»»å‹™ï¼ˆå·²å®Œæˆï¼‰

- [x] **(A) ç·¨è­¯æ¸¬è©¦ï¼šé©—è­‰é …ç›®èƒ½å¦æˆåŠŸç·¨è­¯** +Build #æœ€é«˜å„ªå…ˆç´š {cm:2025-01-27} âœ…
  - **å‰ç«¯æ§‹å»º**: âœ… æˆåŠŸï¼ˆä½¿ç”¨æ¨™æº– webpackï¼‰
  - **Tauri æ§‹å»º**: âœ… æˆåŠŸï¼ˆ3åˆ†55ç§’ï¼‰
  - **æ§‹å»ºç”¢ç‰©**: âœ… å¯åŸ·è¡Œæ–‡ä»¶ã€NSIS å®‰è£ç¨‹åºã€MSI å®‰è£ç¨‹åºå‡å·²ç”Ÿæˆ
  - **ç‹€æ…‹**: âœ… ç·¨è­¯æ¸¬è©¦é€šéï¼Œæ§‹å»ºæˆåŠŸ

---

## ğŸ“š æ–‡æª”èˆ‡é …ç›®ä»»å‹™

- [x] **(B) å°‡ model-card.tsxã€ai.ts å’Œ event-report.ts ä¸­çš„ç¡¬ç·¨ç¢¼æ”¹ç‚ºå¤šåœ‹èªè¨€** +i18n #ä¸­å„ªå…ˆç´š {cm:2025-01-27} âœ…
  - **ä½ç½®**: `src/app/core/setting/ai/model-card.tsx`, `src/lib/ai.ts`, `src/lib/event-report.ts`
  - **ä»»å‹™**: å°‡éŒ¯èª¤è¨Šæ¯ã€æ¸¬è©¦æ–‡å­—å’Œæç¤ºæ–‡å­—ä¸­çš„ç¡¬ç·¨ç¢¼ä¸­æ–‡æ”¹ç‚ºä½¿ç”¨ç¿»è­¯éµå€¼
  - **å·²å®Œæˆ**:
    - âœ… model-card.tsx: æ‰€æœ‰éŒ¯èª¤è¨Šæ¯å·²æ”¹ç‚ºä½¿ç”¨ç¿»è­¯
    - âœ… ai.ts: æ‰€æœ‰éŒ¯èª¤è¨Šæ¯å’Œæç¤ºæ–‡å­—å·²æ”¹ç‚ºä½¿ç”¨ç¿»è­¯ï¼ˆæ·»åŠ äº† getTranslation è¼”åŠ©å‡½æ•¸ï¼‰
    - âœ… event-report.ts: æª¢æŸ¥å¾Œç™¼ç¾ä¸»è¦æ˜¯è¨»é‡‹ï¼Œç„¡éœ€ç¿»è­¯

- [x] **(B) å°‡ sync.tsx å’Œ mark-gen.tsx ä¸­çš„ç¡¬ç·¨ç¢¼æ”¹ç‚ºå¤šåœ‹èªè¨€** +i18n #ä¸­å„ªå…ˆç´š {cm:2025-01-27} âœ…
  - **ä½ç½®**: `src/app/core/article/custom-footer/sync.tsx`, `src/app/core/record/chat/mark-gen.tsx`
  - **ä»»å‹™**: å°‡ AI æç¤ºæ–‡å­—å’ŒéŒ¯èª¤è¨Šæ¯ä¸­çš„ç¡¬ç·¨ç¢¼ä¸­æ–‡æ”¹ç‚ºä½¿ç”¨ç¿»è­¯éµå€¼
  - **éœ€è¦æ·»åŠ çš„ç¿»è­¯éµå€¼**:
    - `article.footer.sync.aiCommitPrompt`: AI ç”Ÿæˆæäº¤ä¿¡æ¯çš„æç¤º
    - `article.footer.sync.requestFailed`: è«‹æ±‚å¤±æ•—æª¢æŸ¥
    - `record.chat.note.scanMarksIntro`: æˆªåœ– OCR è­˜åˆ¥æ–‡å­—ç‰‡æ®µä»‹ç´¹
    - `record.chat.note.textMarksIntro`: æ–‡æœ¬è¤‡è£½è¨˜éŒ„ç‰‡æ®µä»‹ç´¹
    - `record.chat.note.imageMarksIntro`: æ’åœ–è¨˜éŒ„ç‰‡æ®µæè¿°ä»‹ç´¹
    - `record.chat.note.linkMarksIntro`: éˆæ¥è¨˜éŒ„å…§å®¹ä»‹ç´¹
    - `record.chat.note.fileMarksIntro`: æ–‡ä»¶è¨˜éŒ„ç‰‡æ®µæè¿°ä»‹ç´¹
    - `record.chat.note.markItem`: ç¬¬ X æ¢è¨˜éŒ„å…§å®¹
    - `record.chat.note.createdAt`: å‰µå»ºæ–¼
    - `record.chat.note.imageDesc`: æè¿°
    - `record.chat.note.imageUrl`: åœ–ç‰‡åœ°å€
    - `record.chat.note.linkTitle`: æ¨™é¡Œ
    - `record.chat.note.linkUrl`: éˆæ¥
    - `record.chat.note.linkContent`: å…§å®¹
    - `record.chat.note.fileContent`: å…§å®¹
    - `record.chat.note.meetRequirement`: æ»¿è¶³éœ€æ±‚
    - `record.chat.note.noRecordsMessage`: å¦‚æœè¨˜éŒ„å…§å®¹ç‚ºç©ºï¼Œå‰‡è¿”å›æœ¬æ¬¡æ•´ç†ä¸­ä¸å­˜åœ¨ä»»ä½•è¨˜éŒ„ä¿¡æ¯
    - `record.chat.note.formatRequirements`: æ»¿è¶³ä»¥ä¸‹æ ¼å¼è¦æ±‚
    - `record.chat.note.useLanguage`: ä½¿ç”¨ {locale} èªè¨€
    - `record.chat.note.useMarkdown`: ä½¿ç”¨ Markdown èªæ³•
    - `record.chat.note.ensureHeading`: ç¢ºä¿å­˜åœ¨ä¸€ç´šæ¨™é¡Œ
    - `record.chat.note.correctOrder`: ç­†è¨˜é †åºå¯èƒ½æ˜¯éŒ¯èª¤çš„ï¼Œè¦æŒ‰ç…§æ­£ç¢ºé †åºæ’åˆ—
    - `record.chat.note.referenceLinks`: å¦‚æœå­˜åœ¨éˆæ¥è¨˜éŒ„ï¼Œå°‡å…¶ä½œç‚ºåƒè€ƒéˆæ¥æ”¾åœ¨æ–‡ç« æœ«å°¾ï¼Œæ ¼å¼å¦‚ä¸‹
    - `record.chat.note.referenceLinksTitle`: åƒè€ƒéˆæ¥
    - `record.chat.note.imagePlacement`: å¦‚æœå­˜åœ¨æ’åœ–è¨˜éŒ„ï¼Œé€šéæ’åœ–è¨˜éŒ„çš„æè¿°ï¼Œå°‡åœ–ç‰‡éˆæ¥æ”¾åœ¨ç­†è¨˜ä¸­çš„é©åˆä½ç½®ï¼Œåœ–ç‰‡åœ°å€åŒ…å« uuidï¼Œè«‹å®Œæ•´è¿”å›ï¼Œä¸¦å°æ’åœ–é™„å¸¶ç°¡å–®çš„æè¿°

- [x] **(B) å‰µå»ºé …ç›®æ¦‚è¦½æ–‡æª” (PROJECT_OVERVIEW.md)** +Documentation {cm:2025-01-27} âœ…
  - **ä½ç½®**: `docs/PROJECT_OVERVIEW.md`
  - **ç‹€æ…‹**: å·²å®Œæˆ

- [x] **(B) å‰µå»ºå‰ç«¯æ¶æ§‹æ–‡æª” (FRONTEND_ARCH.md)** +Documentation {cm:2025-01-27} âœ…
  - **ä½ç½®**: `docs/FRONTEND_ARCH.md`
  - **ç‹€æ…‹**: å·²å®Œæˆ

- [x] **(C) å‰µå»º API æ¦‚è¦½æ–‡æª” (API_OVERVIEW.md)** +Documentation {cm:2025-01-27} âœ…
  - **ä½ç½®**: `docs/API_OVERVIEW.md`
  - **ç‹€æ…‹**: å·²å®Œæˆ

- [x] **(B) å‰µå»ºé¦–æ¬¡æƒæç­†è¨˜** +Documentation {cm:2025-01-27} âœ…
  - **ä½ç½®**: `docs/todo/todo2025-01-27-01.md`
  - **ç‹€æ…‹**: å·²å®Œæˆ

- [ ] **(C) å‰µå»ºé—œéµç”¨æˆ¶æµç¨‹æ–‡æª” (ui-flow-*.md)** +Documentation
  - **è¨ˆåŠƒ**: è¨˜éŒ„å¾è¨˜éŒ„åˆ°å¯«ä½œã€AI èŠå¤©ã€åŒæ­¥ã€æœç´¢ç­‰é—œéµæµç¨‹

- [ ] **(B) æª¢æŸ¥ä¸¦æ›´æ–° README.md** +Documentation
  - **ç¼ºå¤±å…§å®¹**: é–‹ç™¼ç’°å¢ƒè¨­ç½®æ­¥é©Ÿã€æœ¬åœ°é–‹ç™¼æŒ‡å—ã€æ§‹å»ºèªªæ˜

---

## ğŸ“– å­¸ç¿’è¨ˆåŠƒä»»å‹™ï¼ˆå·²å®Œæˆï¼‰

**ç•¶å‰ç†è§£ç­‰ç´š**: 85-90% âœ…  
**ç›®æ¨™ç†è§£ç­‰ç´š**: 90% âœ…  
**è©³ç´°è¨ˆåŠƒæ–‡æª”**: `docs/LEARNING_PLAN.md`  
**å­¸ç¿’ç­†è¨˜**: `docs/LEARNING_NOTES.md`

## âœ… å·²å®Œæˆéšæ®µ

- [x] **éšæ®µ 1ï¼šæ ¸å¿ƒæ¥­å‹™é‚è¼¯æ·±å…¥** âœ…
  - [x] è¨˜éŒ„åˆ°å¯«ä½œæµç¨‹ï¼ˆ60% â†’ 80%ï¼‰
  - [x] AI èŠå¤©æµç¨‹ï¼ˆ40% â†’ 90%ï¼‰
  - [x] åŒæ­¥åŠŸèƒ½ï¼ˆ40% â†’ 85%ï¼‰
  - [x] æœç´¢åŠŸèƒ½ï¼ˆ50% â†’ 85%ï¼‰

- [x] **éšæ®µ 2ï¼šç‹€æ…‹ç®¡ç†æ·±å…¥** âœ…
  - [x] Stores ä¾è³´é—œä¿‚åˆ†æï¼ˆ50% â†’ 90%ï¼‰

- [x] **éšæ®µ 3ï¼šæ•¸æ“šæµå’ŒéŒ¯èª¤è™•ç†** âœ…
  - [x] Tauri Commands æ·±å…¥å­¸ç¿’ï¼ˆ60% â†’ 80%ï¼‰

- [x] **éšæ®µ 4ï¼šé‚Šç•Œæƒ…æ³å’Œç‰¹æ®Šé‚è¼¯** âœ…
  - [x] é‚Šç•Œæƒ…æ³è™•ç†åˆ†æï¼ˆ30% â†’ 80%ï¼‰

- [x] **éšæ®µ 5ï¼šä»£ç¢¼ä¾è³´é—œä¿‚** âœ…
  - [x] ä»£ç¢¼ä¾è³´é—œä¿‚åˆ†æï¼ˆ50% â†’ 75%ï¼‰

### âœ… é”åˆ° 90% çš„æ¨™èªŒï¼ˆå…¨éƒ¨é”æˆï¼‰

- [x] èƒ½å¤ é æ¸¬ä»£ç¢¼è¡Œç‚º âœ…
- [x] ç†è§£å®Œæ•´çš„æ•¸æ“šæµ âœ…
- [x] ç†è§£éŒ¯èª¤è™•ç†æ©Ÿåˆ¶ âœ…
- [x] ç†è§£ä¾è³´é—œä¿‚ âœ…
- [x] èƒ½å¤ å®‰å…¨åœ°ä¿®æ”¹ä»£ç¢¼ âœ…

---

## ğŸ”§ é–‹ç™¼è¦å‰‡èˆ‡æœ€ä½³å¯¦è¸

### API éŒ¯èª¤è™•ç†æ©Ÿåˆ¶ï¼ˆ403 éŒ¯èª¤ï¼‰

**é©ç”¨å ´æ™¯**: æ‰€æœ‰éœ€è¦å€åˆ† API Key éŒ¯èª¤å’Œé€Ÿç‡é™åˆ¶çš„ API è«‹æ±‚

**è¦å‰‡èªªæ˜**:

1. **éŒ¯èª¤é¡å‹åˆ¤æ–·**
   - ç•¶æ”¶åˆ° `403 Forbidden` éŸ¿æ‡‰æ™‚ï¼Œéœ€è¦è®€å–éŸ¿æ‡‰é«”åˆ¤æ–·éŒ¯èª¤é¡å‹
   - æª¢æŸ¥éŒ¯èª¤ä¿¡æ¯ä¸­æ˜¯å¦åŒ…å«ä»¥ä¸‹é—œéµè©ï¼ˆä¸å€åˆ†å¤§å°å¯«ï¼‰ï¼š
     - `api key`ã€`apikey`
     - `invalid key`ã€`invalid api`ã€`api key is invalid`ã€`api key invalid`
     - `unauthorized`ã€`authentication`
     - `permission denied`
     - `forbidden`ï¼ˆåƒ…ä½œç‚ºè¼”åŠ©åˆ¤æ–·ï¼‰

2. **API Key éŒ¯èª¤è™•ç†**
   - å¦‚æœæª¢æ¸¬åˆ°æ˜¯ API Key éŒ¯èª¤ï¼Œ**ç«‹å³å ±éŒ¯ï¼Œä¸é€²è¡Œé‡è©¦**
   - é¡¯ç¤ºæ˜ç¢ºçš„éŒ¯èª¤æç¤ºï¼Œå‘ŠçŸ¥ç”¨æˆ¶æª¢æŸ¥ API Key
   - éŒ¯èª¤æç¤ºæ‡‰åŒ…å«ï¼š
     - API Key æ˜¯å¦æ­£ç¢º
     - API Key æ˜¯å¦æœ‰æ¬Šé™è¨ªå•å°æ‡‰ç«¯é»
     - æ˜¯å¦å·²æ­£ç¢ºé…ç½® API Key

3. **é€Ÿç‡é™åˆ¶è™•ç†**
   - å¦‚æœä¸æ˜¯ API Key éŒ¯èª¤ï¼Œè¦–ç‚ºé€Ÿç‡é™åˆ¶
   - é¡¯ç¤ºç­‰å¾…æç¤ºï¼Œå‘ŠçŸ¥ç”¨æˆ¶æ­£åœ¨ç­‰å¾…æ¨¡å‹å›æ‡‰
   - å¯¦ç¾é‡è©¦æ©Ÿåˆ¶ï¼š
     - æœ€å¤šé‡è©¦ 3 æ¬¡
     - ç­‰å¾…æ™‚é–“éå¢ï¼š5ç§’ã€10ç§’ã€15ç§’
     - æ¯æ¬¡é‡è©¦éƒ½é¡¯ç¤ºæç¤ºï¼ŒåŒ…å«ç­‰å¾…æ™‚é–“å’Œé‡è©¦é€²åº¦ï¼ˆå¦‚ï¼š`ç­‰å¾… 5 ç§’å¾Œé‡è©¦ (1/3)...`ï¼‰

4. **ç”¨æˆ¶æç¤ºè¦æ±‚**
   - API Key éŒ¯èª¤ï¼šä½¿ç”¨ `variant: 'destructive'` çš„ toast æç¤º
   - é€Ÿç‡é™åˆ¶ï¼šä½¿ç”¨ `variant: 'default'` çš„ toast æç¤ºï¼Œæ¨™é¡Œç‚ºã€Œç­‰å¾…æ¨¡å‹å›æ‡‰ã€
   - æ‰€æœ‰æç¤ºéƒ½æ‡‰æ”¯æŒå¤šèªè¨€

5. **å¯¦ç¾ä½ç½®**
   - **ç•¶å‰å¯¦ç¾**: `src/lib/ai.ts` çš„ `fetchEmbedding` å‡½æ•¸
   - **ç¿»è­¯éµå€¼**:
     - `ai.error.embeddingApiKeyInvalid`: API Key ç„¡æ•ˆéŒ¯èª¤æç¤º
     - `ai.error.embeddingRateLimitTitle`: é€Ÿç‡é™åˆ¶ç­‰å¾…æ¨™é¡Œ
     - `ai.error.embeddingRateLimitWaiting`: é€Ÿç‡é™åˆ¶ç­‰å¾…æç¤ºï¼ˆåŒ…å« `{waitTime}`, `{retryCount}`, `{maxRetries}` åƒæ•¸ï¼‰

**å¾ŒçºŒæ‡‰ç”¨**:

- ç•¶å…¶ä»– API è«‹æ±‚ï¼ˆå¦‚ Rerankã€Chat ç­‰ï¼‰é‡åˆ°é¡ä¼¼ 403 éŒ¯èª¤æ™‚ï¼Œæ‡‰å¥—ç”¨ç›¸åŒçš„è™•ç†è¦å‰‡
- ç¢ºä¿æ‰€æœ‰ç›¸é—œçš„éŒ¯èª¤è™•ç†éƒ½éµå¾ªæ­¤æ©Ÿåˆ¶

**åƒè€ƒä»£ç¢¼**:

```typescript
// æª¢æŸ¥æ˜¯å¦æ˜¯ API key ç›¸é—œéŒ¯èª¤
const errorMessage = errorBody?.error?.message || errorBody?.message || errorBody?.error || '';
const errorMessageLower = errorMessage.toLowerCase();
const isApiKeyError = errorMessage && (
    errorMessageLower.includes('api key') ||
    errorMessageLower.includes('apikey') ||
    errorMessageLower.includes('invalid key') ||
    errorMessageLower.includes('unauthorized') ||
    errorMessageLower.includes('authentication') ||
    errorMessageLower.includes('permission denied') ||
    errorMessageLower.includes('invalid api') ||
    errorMessageLower.includes('api key is invalid') ||
    errorMessageLower.includes('api key invalid')
);

// API Key éŒ¯èª¤ï¼šç«‹å³å ±éŒ¯
if (isApiKeyError) {
    const apiKeyErrorMsg = await getTranslation('ai.error.embeddingApiKeyInvalid');
    toast({
        title: await getTranslation('ai.error.title'),
        description: apiKeyErrorMsg,
        variant: 'destructive',
    });
    throw new Error(apiKeyErrorMsg);
}

// é€Ÿç‡é™åˆ¶ï¼šé‡è©¦æ©Ÿåˆ¶
const maxRetries = 3;
if (retryCount < maxRetries) {
    const waitTime = (retryCount + 1) * 5000;
    const waitingMsg = await getTranslation('ai.error.embeddingRateLimitWaiting', {
        waitTime: (waitTime / 1000).toString(),
        retryCount: (retryCount + 1).toString(),
        maxRetries: maxRetries.toString()
    });
    toast({
        title: await getTranslation('ai.error.embeddingRateLimitTitle'),
        description: waitingMsg,
        variant: 'default',
    });
    await new Promise(resolve => setTimeout(resolve, waitTime));
    return fetchEmbedding(text, retryCount + 1);
}
```

---

### UI å¸ƒå±€è¨­è¨ˆè¦å‰‡ï¼ˆç‹€æ…‹åˆ—é«˜åº¦åˆ†é…ï¼‰

**é©ç”¨å ´æ™¯**: æ‰€æœ‰éœ€è¦æ·»åŠ åº•éƒ¨ç‹€æ…‹åˆ—çš„é é¢çµ„ä»¶

**è¦å‰‡èªªæ˜**:

1. **ç‹€æ…‹åˆ—æ¨™æº–é«˜åº¦**
   - æ‰€æœ‰ç‹€æ…‹åˆ—çµ±ä¸€ä½¿ç”¨ `h-6`ï¼ˆ24pxï¼‰é«˜åº¦
   - å°æ‡‰ Tailwind CSS é¡ï¼š`h-6` = `1.5rem` = `24px`

2. **é«˜åº¦åˆ†é…åŸå‰‡**
   - ç•¶é é¢éœ€è¦æ·»åŠ ç‹€æ…‹åˆ—æ™‚ï¼Œ**æ‡‰å¾ä½¿ç”¨ `flex-1` çš„å…§å®¹å€åŸŸè‡ªå‹•æ¸›å°‘é«˜åº¦**
   - ä½¿ç”¨ `flex-1` çš„çµ„ä»¶æœƒè‡ªå‹•ä½”æ“šå‰©é¤˜ç©ºé–“ï¼Œç„¡éœ€æ‰‹å‹•è¨ˆç®—é«˜åº¦
   - ä¿æŒéŸ¿æ‡‰å¼å¸ƒå±€ï¼Œè®“ Flexbox è‡ªå‹•è™•ç†é«˜åº¦åˆ†é…

3. **çµ„ä»¶çµæ§‹æ¨¡å¼**

   **Article é é¢ï¼ˆå·²æœ‰ç‹€æ…‹åˆ—ï¼‰**ï¼š

   ```
   Article çµ„ä»¶ (h-screen, flex-col)
   â”œâ”€â”€ CustomToolbar (å›ºå®šé«˜åº¦)
   â”œâ”€â”€ ç·¨è¼¯å™¨å…§å®¹å€åŸŸ (flex-1) â† è‡ªå‹•é©æ‡‰ç‹€æ…‹åˆ—é«˜åº¦
   â””â”€â”€ CustomFooter (h-6, 24px) â† ç‹€æ…‹åˆ—
   ```

   **Chat çµ„ä»¶ï¼ˆå¦‚éœ€æ·»åŠ ç‹€æ…‹åˆ—ï¼‰**ï¼š

   ```
   Chat çµ„ä»¶ (h-screen, flex-col)
   â”œâ”€â”€ ChatHeader (å›ºå®šé«˜åº¦)
   â”œâ”€â”€ ChatContent (flex-1) â† è‡ªå‹•æ¸›å°‘ 24px
   â”œâ”€â”€ ClipboardListener (éš±è—)
   â”œâ”€â”€ ChatInput (å›ºå®šé«˜åº¦)
   â””â”€â”€ ChatFooter (h-6, 24px) â† æ–°å¢ç‹€æ…‹åˆ—
   ```

4. **å¯¦ç¾è¦é»**
   - ç‹€æ…‹åˆ—æ‡‰æ”¾åœ¨çµ„ä»¶çš„æœ€åº•éƒ¨
   - å…§å®¹å€åŸŸå¿…é ˆä½¿ç”¨ `flex-1` ä»¥å¯¦ç¾è‡ªå‹•é«˜åº¦èª¿æ•´
   - ä¸éœ€è¦æ‰‹å‹•è¨ˆç®—æˆ–è¨­ç½®å…·é«”é«˜åº¦å€¼
   - èˆ‡ Article é é¢çš„è¨­è¨ˆæ¨¡å¼ä¿æŒä¸€è‡´

5. **åƒè€ƒæ–‡ä»¶**
   - **ç‹€æ…‹åˆ—çµ„ä»¶**: `src/app/core/article/custom-footer/index.tsx`
   - **Article é é¢çµæ§‹**: `src/app/core/article/md-editor.tsx`
   - **Chat çµ„ä»¶çµæ§‹**: `src/app/core/record/chat/index.tsx`

**å¾ŒçºŒæ‡‰ç”¨**:

- ç•¶å…¶ä»–é é¢éœ€è¦æ·»åŠ ç‹€æ…‹åˆ—æ™‚ï¼Œæ‡‰éµå¾ªç›¸åŒçš„è¨­è¨ˆæ¨¡å¼
- ç¢ºä¿æ‰€æœ‰ç‹€æ…‹åˆ—çš„é«˜åº¦çµ±ä¸€ç‚º 24px
- ä½¿ç”¨ Flexbox çš„ `flex-1` å¯¦ç¾è‡ªå‹•é«˜åº¦åˆ†é…ï¼Œé¿å…ç¡¬ç·¨ç¢¼é«˜åº¦å€¼

---

## ğŸ“ æª¢æŸ¥ç¯„åœ

- âœ… å·²æª¢æŸ¥ `src/` ç›®éŒ„ä¸‹çš„æ‰€æœ‰ä¸»è¦æ–‡ä»¶
- âœ… å·²æª¢æŸ¥é…ç½®æ–‡ä»¶ï¼ˆ`tauri.conf.json`, `capabilities/`ï¼‰
- âœ… å·²æª¢æŸ¥æ•¸æ“šåº«æ“ä½œæ–‡ä»¶
- âœ… å·²æª¢æŸ¥ç¶²çµ¡è«‹æ±‚ç›¸é—œæ–‡ä»¶
- âœ… å·²æª¢æŸ¥æ–‡ä»¶æ“ä½œç›¸é—œæ–‡ä»¶
- âœ… å·²æª¢æŸ¥ç”¨æˆ¶è¼¸å…¥è™•ç†
- âœ… å·²æª¢æŸ¥æ•æ„Ÿä¿¡æ¯å­˜å„²

---

## ğŸ’¡ å»ºè­°

- å»ºè­°å„ªå…ˆè™•ç†é«˜é¢¨éšªå®‰å…¨å•é¡Œ
- æ‰€æœ‰æ•æ„Ÿä¿¡æ¯æ‡‰ä½¿ç”¨ç’°å¢ƒè®Šé‡æˆ–åŠ å¯†å­˜å„²
- å®šæœŸé€²è¡Œå®‰å…¨å¯©è¨ˆå’Œä¾è³´é …æ›´æ–°
- è€ƒæ…®ä½¿ç”¨å®‰å…¨æƒæå·¥å…·ï¼ˆå¦‚ npm audit, cargo auditï¼‰
- å¯¦æ–½ä»£ç¢¼å¯©æŸ¥æµç¨‹ï¼Œç‰¹åˆ¥é—œæ³¨å®‰å…¨ç›¸é—œè®Šæ›´
